---
title: Reddish - Writteup
date: 2022-11-22 13:00:00 +/-TTTT
categories: htb
tags: Reddish htb
img_path: /recursos/images
---


![](Pasted image 20221114202315.png)


### User

![](Pasted image 20221114202631.png)
![](Pasted image 20221114202733.png)

![](Pasted image 20221114202807.png)
![](Pasted image 20221114202817.png)

![](Pasted image 20221114202853.png)
![](Pasted image 20221114202908.png)

![](Pasted image 20221114202924.png)
![](Pasted image 20221114202946.png)


![](Pasted image 20221114203145.png)

![](Pasted image 20221114203210.png)

![](Pasted image 20221114203239.png)

![](Pasted image 20221114203302.png)

![](Pasted image 20221114203344.png)

![](Pasted image 20221114203359.png)

![](Pasted image 20221114203449.png)

![](Pasted image 20221114203506.png)

![](Pasted image 20221114204001.png)

![](Pasted image 20221114204020.png)

![](Pasted image 20221114204119.png)

![](Pasted image 20221114204147.png)

![](Pasted image 20221114210026.png)

![](Pasted image 20221114210054.png)
![](Pasted image 20221114210141.png)

![](Pasted image 20221114210156.png)

![](Pasted image 20221114210302.png)
![](Pasted image 20221114210413.png)
![](Pasted image 20221114210511.png)

(en la captura las ips salen mal separadas lo corrijo despues)

![](Pasted image 20221114210748.png)
![](Pasted image 20221114211855.png)
![](Pasted image 20221114212212.png)

![](Pasted image 20221114212453.png)

![](Pasted image 20221115113500.png)

![](Pasted image 20221115115218.png)

Fuzzeando no conseguiríamos nada

![](Pasted image 20221115115236.png)

![](Pasted image 20221115115414.png)

![](Pasted image 20221115120303.png)
![](Pasted image 20221115120432.png)

![](Pasted image 20221115115440.png)

![](Pasted image 20221115115705.png)
![](Pasted image 20221115115725.png)
![](Pasted image 20221115115750.png)

![](Pasted image 20221115115841.png)


![](Pasted image 20221115163414.png)

![](Pasted image 20221115163741.png)

Seguimos los pasos de hacktricks para intentar depositar contenido en la web mediante esto

![](Pasted image 20221115164356.png)


![](Pasted image 20221115164431.png)
![](Pasted image 20221115164519.png)
![](Pasted image 20221115164605.png)
![](Pasted image 20221115164749.png)

Nos metemos las anteriores instrucciones en un script por si nuestro archivo desapareciese


![](Pasted image 20221115164807.png)

Con socat redirigimos lo que llegue al puerto 1111 de la maquina a nuestro puerto 2222 la idea aquí es lanzar una reverse shell contra esta maquina
en el puerto 1111 y que nos llegue a nosotros por el puerto 2222 

![](Pasted image 20221115170230.png)

Importante urlencodear los ampersand

![](Pasted image 20221115170021.png)


Y recibimos nuestra reverse shell

![](Pasted image 20221115170344.png)

Vemos un nuevo segmento de red el cual no podemos enumerar ya que no podemos ejecutar ping
por lo que probablemente tengamos que convertirnos en root

![](Pasted image 20221115170952.png)

Así iria quedando nuestro esquema de red

![](Pasted image 20221115171103.png)

Enumerando y viendo el crontab vemos que ejecuta un script

![](Pasted image 20221115171408.png)

Tambien podriamos haberlo enumerado con el siguiente script:

![](Pasted image 20221115172052.png)

El cual se nos ocurría una forma de abusar de el viendo el empleo de los *

![](Pasted image 20221115171455.png)

Mirando en GTFObins vemos esto:

![](Pasted image 20221115171601.png)

Mirando el man vemos que -e se emplea para indicarle una shell alternativa y ademas podemos jugar con esta
para que nos ejecute un comando

![](Pasted image 20221115172403.png)

![](Pasted image 20221115172654.png)

![](Pasted image 20221115172717.png)

![](Pasted image 20221115172819.png)

![](Pasted image 20221115172938.png)


### Root

![](Pasted image 20221115173625.png)
![](Pasted image 20221115173656.png)

El puerto 873 es el empleado por rysnc asi que vamos a ver si podemos usarlo para conectarnos a la maquina que vimos en el script

![](Pasted image 20221115174226.png)

Y así es

![](Pasted image 20221115174422.png)

Por lo que se nos ocurre viendo que está activo el servicio cron es subirnos un archivo con formato cron
que nos entable una reverse shell

![](Pasted image 20221115174602.png)


Nos creamos un cron que cada minuto el usuario root nos ejecute con sh /tmp/reverse.sh

![](Pasted image 20221115174733.png)
![](Pasted image 20221115174827.png)
![](Pasted image 20221115174848.png)

Con socat nos motamos otra redirección

Para podernos pasar el socat entre la ultima maquina y la nuestra

![](Pasted image 20221115175853.png)

Ahora solo nos quedaría pasarle eso a la maquina y con rsync ponerlo en /tmp como reverse.sh para que mediante socat nos llegue

![](Pasted image 20221115180512.png)

![](Pasted image 20221115180653.png)

![](Pasted image 20221115180859.png)

![](Pasted image 20221115181157.png)

![](Pasted image 20221115181309.png)

![](Pasted image 20221115181332.png)

Para ganar una shell interactiva podríamos hacer lo siguiente ya que esto tiene pinta de que es la montura
del sistema real

(no se ve pero pone tarea)

![](Pasted image 20221115181521.png)

![](Pasted image 20221115181614.png)

![](Pasted image 20221115181725.png)

![](Pasted image 20221115181829.png)

![](Pasted image 20221115181930.png)

Así habría quedado el esquema final

![](Pasted image 20221115182053.png)


#Linux #htb [[HTB]] #Abusing_Node-Red #Chisel_Socat #Redis-CliExploitation #RsyncAbusing #CronExploitation #DiskMount #FileTransferTips #Pivoting #eCPPTv2 #eCPTXv2 #Insane 
